<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <title>Round 2 | Audio Morse</title>
  <link rel="icon" type="image/png" href="hackher 1.png">
  <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: "Space Mono", monospace;
      background: #0b1020;
      color: #e6eef8;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      margin: 0;
      padding: 24px;
    }
    .card {
      background: linear-gradient(180deg,#0f1724,#071028);
      border-radius: 10px;
      padding: 24px;
      width: 420px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    }
    h1 { font-size: 18px; margin: 0 0 12px; }
    p { margin: 8px 0 16px; color: #bcd3f0; }
    .controls { display:flex; gap:8px; margin-bottom:12px; }
    button {
      background:#1f6feb;
      color:white;
      border:0;
      padding:10px 14px;
      border-radius:6px;
      cursor:pointer;
      font-weight:700;
    }
    button.secondary { background:#2b394f; }
    input[type="text"] {
      width:100%;
      padding:10px;
      border-radius:6px;
      border:1px solid #203040;
      background:#071226;
      color:#e6eef8;
      box-sizing:border-box;
      margin-bottom:12px;
    }
    .hint { font-size:12px; color:#8fa8d6; margin-bottom:8px; }
    .status { font-size:13px; color:#9fe3a6; min-height:18px; }
  </style>
</head>
<body>
  <main class="card" role="main">
    <h1>Round 2 – Audio Morse</h1>
    <p>Listen to the Morse code and type the decoded word below.</p>

    <!-- Audio element (hidden controls) -->
    <audio id="morseAudio" preload="auto">
      <!-- Replace src with your actual audio file path -->
      <source src="audio/morse-round2.mp3" type="audio/mpeg">
      Your browser does not support the audio element.
    </audio>

    <!-- Controls and inputs with matching IDs used by the script -->
    <div class="controls">
      <button id="playButton" type="button">▶ PLAY AUDIO</button>
      <button id="pauseButton" type="button" class="secondary">⏸ PAUSE</button>
      <button id="replayButton" type="button" class="secondary">↺ REPLAY</button>
    </div>

    <div class="hint">TYPE YOUR ANSWER (eg : TOWER)</div>
    <input id="answerInput" type="text" placeholder="Type your answer here" autocomplete="off" />
    <div style="display:flex; gap:8px;">
      <button id="submitButton" type="button">SUBMIT →</button>
      <button id="clearButton" type="button" class="secondary">CLEAR</button>
    </div>

    <div class="status" id="statusMessage" aria-live="polite"></div>
  </main>

  <script>
    // Run after DOM is ready to avoid null element references
    document.addEventListener("DOMContentLoaded", () => {
      // Grab elements safely
      const playBtn = document.getElementById("playButton");
      const pauseBtn = document.getElementById("pauseButton");
      const replayBtn = document.getElementById("replayButton");
      const submitBtn = document.getElementById("submitButton");
      const clearBtn = document.getElementById("clearButton");
      const answerInput = document.getElementById("answerInput");
      const status = document.getElementById("statusMessage");
      const audio = document.getElementById("morseAudio");

      // Defensive checks: if any required element is missing, log and stop
      if (!audio) {
        console.error("Audio element not found. Make sure #morseAudio exists.");
        if (status) status.textContent = "Audio element missing.";
        return;
      }

      // Helper to update status text
      function setStatus(text, isError = false) {
        if (status) {
          status.textContent = text;
          status.style.color = isError ? "#ff8a8a" : "#9fe3a6";
        }
      }

      // Play audio
      if (playBtn) {
        playBtn.addEventListener("click", () => {
          audio.play().then(() => {
            setStatus("Playing audio...");
          }).catch(err => {
            console.error("Playback failed:", err);
            setStatus("Playback failed. Check audio file or browser autoplay settings.", true);
          });
        });
      }

      // Pause audio
      if (pauseBtn) {
        pauseBtn.addEventListener("click", () => {
          audio.pause();
          setStatus("Paused.");
        });
      }

      // Replay from start
      if (replayBtn) {
        replayBtn.addEventListener("click", () => {
          audio.currentTime = 0;
          audio.play().then(() => setStatus("Replaying audio..."))
            .catch(err => {
              console.error("Replay failed:", err);
              setStatus("Replay failed.", true);
            });
        });
      }

      // Submit answer
      if (submitBtn && answerInput) {
        submitBtn.addEventListener("click", () => {
          const answer = answerInput.value.trim();
          if (!answer) {
            setStatus("Please enter an answer before submitting.", true);
            return;
          }
          // Example validation: uppercase and simple check
          const normalized = answer.toUpperCase();
          // Replace the expectedAnswer with your actual expected value or server check
          const expectedAnswer = "TOWER";
          if (normalized === expectedAnswer) {
            setStatus("Correct! Well done.");
          } else {
            setStatus("Incorrect. Try again.", true);
          }
        });
      }

      // Clear input
      if (clearBtn && answerInput) {
        clearBtn.addEventListener("click", () => {
          answerInput.value = "";
          setStatus("");
          answerInput.focus();
        });
      }

      // Optional: keyboard submit on Enter
      if (answerInput) {
        answerInput.addEventListener("keydown", (e) => {
          if (e.key === "Enter") {
            e.preventDefault();
            if (submitBtn) submitBtn.click();
          }
        });
      }

      // Audio ended event
      audio.addEventListener("ended", () => {
        setStatus("Audio ended.");
      });

      // If audio fails to load, show message
      audio.addEventListener("error", (e) => {
        console.error("Audio error event:", e);
        setStatus("Failed to load audio. Check the file path.", true);
      });

      // Focus input for convenience
      if (answerInput) answerInput.focus();
    });
  </script>
</body>
</html>
